/* ================================
   Design Tokens
==================================*/
:root{
  --bg-0:#0b0f1a;
  --bg-1:#0f1422;
  --bg-2:#1b2460;
  --bg-3:#4b1458;

  --text:#e6eefc;
  --muted:#9fb2d1;

  --primary:#5aa9ff;
  --accent:#7c4dff;

  --surface-0:rgba(255,255,255,.04);
  --surface-1:rgba(255,255,255,.06);
  --surface-2:rgba(255,255,255,.12);
  --surface-3:rgba(255,255,255,.16);

  --radius-lg:24px;
  --radius-md:16px;
  --radius-sm:10px;

  --shadow-0:0 10px 40px rgba(0,0,0,.35);
  --shadow-1:0 20px 60px rgba(0,0,0,.35);
  --shadow-2:0 24px 80px rgba(0,0,0,.45);
}

/* light theme (optional)
html[data-theme="light"]{
  --bg-0:#f6f7fb; --bg-1:#fdfefe;
  --text:#0b1220; --muted:#5b6b84;
  --surface-0:rgba(0,0,0,.04);
  --surface-1:rgba(0,0,0,.06);
  --surface-2:rgba(0,0,0,.12);
  --surface-3:rgba(0,0,0,.18);
}
*/

/* ================================
   Reset / Global
==================================*/
*{box-sizing:border-box}
html,body,#root{height:100%}
html{scroll-behavior:smooth}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,Noto Sans;
  color:var(--text);
  background:
    radial-gradient(1200px 600px at 20% -10%, var(--bg-2) 0%, transparent 60%),
    radial-gradient(900px 500px at 110% 10%, var(--bg-3) 0%, transparent 55%),
    linear-gradient(180deg,var(--bg-0) 0%,var(--bg-1) 100%);
  animation:bgFloat 20s ease-in-out infinite alternate;
}
a{color:var(--primary);text-decoration:none}
a:hover{text-decoration:underline}
@keyframes bgFloat{
  from{background-position:0 0,0 0,0 0}
  to  {background-position:-40px -30px,30px 20px,0 0}
}

/* subtle grain */
body::before{
  content:""; position:fixed; inset:0; pointer-events:none; z-index:0;
  background-image:
    radial-gradient(circle at 25% 20%, rgba(255,255,255,.03) 0 2px, transparent 2px),
    radial-gradient(circle at 75% 60%, rgba(255,255,255,.02) 0 1.5px, transparent 1.5px);
  background-size:6px 6px,5px 5px;
  mix-blend-mode:overlay; opacity:.35;
}

/* optional watermark
body::after{
  content:"Nubiz";
  position:fixed; inset:0; pointer-events:none; z-index:3;
  display:grid; place-items:center;
  font-size:clamp(120px,20vw,260px); font-weight:900; letter-spacing:8px;
  color:#ffffff14; filter:blur(1.5px); mix-blend-mode:soft-light;
}
*/

/* Reduced motion */
@media (prefers-reduced-motion:reduce){
  *{animation-duration:.001ms !important;animation-iteration-count:1 !important;transition-duration:.001ms !important}
}

/* ================================
   Layout / Shell
==================================*/
html,body{overflow:hidden;}           /* 발표용: 페이지 전체 스크롤 잠금 */
.snap-container{
  height:100vh; overflow-y:auto;      /* 스냅 컨테이너만 스크롤 */
  scroll-snap-type:y mandatory;
  scrollbar-width:none; -ms-overflow-style:none;
}
.snap-container::-webkit-scrollbar{display:none;}

.snap-section{
  height:100vh; scroll-snap-align:start;
  display:grid; place-items:center;
  padding:48px 24px; position:relative;
}
.section-panel{
  width:min(1100px,92vw);
  padding:32px;
  border-radius:var(--radius-lg);
  background:var(--surface-0);
  border:1px solid var(--surface-2);
  backdrop-filter:blur(6px);
  box-shadow:var(--shadow-1);
  transform:translateY(32px);
  opacity:0;
  transition:transform .6s ease,opacity .6s ease,box-shadow .6s ease;
}
.section-panel::before{
  content:""; position:absolute; inset:0; z-index:-1;
  border-radius:inherit; background:inherit; backdrop-filter:blur(10px);
  border:1px solid var(--surface-2); mix-blend-mode:overlay;
}
.inview .section-panel{transform:translateY(0); opacity:1}

/* ================================
   Band Backgrounds
==================================*/
.band-intro{
  background:linear-gradient(180deg,rgba(90,169,255,.10) 0%,rgba(90,169,255,0) 60%),transparent;
}
.band-body{ background:transparent; }
.band-outro{
  background:linear-gradient(180deg,rgba(124,77,255,.10) 0%,rgba(124,77,255,0) 60%),transparent;
}

/* ================================
   Intro Splash
==================================*/
.intro-backdrop{
  position:fixed; inset:0; display:grid; place-items:center; z-index:60;
  background:
    radial-gradient(1000px 600px at 40% 20%,rgba(90,169,255,.12),transparent),
    radial-gradient(800px 500px at 70% 60%,rgba(124,77,255,.12),transparent),
    rgba(7,10,18,.75);
  backdrop-filter:blur(4px); animation:introFade .5s ease both;
}
@keyframes introFade{from{opacity:0}to{opacity:1}}
.intro-card{
  padding:32px 36px; border-radius:var(--radius-lg);
  background:rgba(17,22,35,.85); border:1px solid var(--surface-2);
  box-shadow:var(--shadow-2); text-align:center;
}
.intro-title{font-size:32px;font-weight:800}
.intro-sub{margin-top:8px;opacity:.85}
.intro-cta{
  margin-top:16px; font-size:14px; opacity:.9;
  background:var(--surface-1); border:1px solid var(--surface-3);
  display:inline-block; padding:8px 12px; border-radius:9999px;
}

/* ================================
   Overlay (Modal)
==================================*/
.ov-backdrop{
  position:fixed; inset:0; z-index:90; display:grid; place-items:center;
  background:rgba(2,6,23,.6); backdrop-filter:blur(3px);
  animation:fade .25s both;
}
@keyframes fade{from{opacity:0}to{opacity:1}}
.ov-card{
  max-width:min(90vw,900px); max-height:90vh; overflow:auto;
  background:#151924; border-radius:18px; padding:32px 36px; position:relative;
  border:1px solid var(--surface-2); box-shadow:var(--shadow-2);
}
.ov-close{
  position:absolute; top:18px; right:18px;
  background:var(--surface-1); border:1px solid var(--surface-2); color:#fff;
  padding:6px 12px; border-radius:9999px; cursor:pointer;
}
.ov-btn{
  margin-top:12px; padding:6px 12px; border-radius:8px; cursor:pointer;
  background:var(--surface-1); border:1px solid var(--surface-2);
  font-size:13px; color:#e5e7eb;
}

/* ================================
   Tables (simple-table & audit)
==================================*/
.simple-table{
  width:100%; border-collapse:separate; border-spacing:0;
}
.simple-table th, .simple-table td{
  padding:10px 12px; text-align:left;
  border-bottom:1px solid rgba(255,255,255,.06);
}
.simple-table thead th{
  font-weight:700; opacity:.95;
}

.simple-table.audit{
  border-collapse:separate; border-spacing:0 6px;
}
.simple-table.audit thead th{
  position:sticky; top:0; z-index:1;
  background:rgba(15,23,42,.9); backdrop-filter:blur(8px);
  cursor:pointer;
}
.simple-table.audit tbody tr{
  background:#0f172a; border-radius:10px;
}
.simple-table.audit tbody td{ vertical-align:top }
.simple-table.audit tbody tr:nth-child(odd){ background:rgba(255,255,255,.03) }
.simple-table .metric{
  white-space:nowrap; font-family:ui-monospace,SFMono-Regular,Menlo,monospace; font-size:12px;
}

/* ================================
   Audit Toolbar / Filters
==================================*/
.audit-toolbar{
  display:flex; gap:12px; align-items:center; justify-content:space-between;
  margin:-4px 0 10px 0;
}
.audit-toolbar .search{
  flex:1; max-width:360px; padding:8px 10px; border-radius:var(--radius-sm);
  border:1px solid var(--surface-2);
  background:var(--surface-1); color:#e5e7eb;
}
.sev-group{ display:flex; gap:6px; }
.pill{
  padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700;
  border:1px solid transparent; background:var(--surface-1); color:#cbd5e1;
}
.pill.on{ outline:2px solid rgba(255,255,255,.24) }
.pill.sev-critical.on{ background:#b91c1c; color:#fff }
.pill.sev-high.on    { background:#d97706; color:#fff }
.pill.sev-medium.on  { background:#059669; color:#fff }
.pill.sev-low.on     { background:#2563eb; color:#fff }

button.linklike.ghost{
  padding:6px 10px; border-radius:8px;
  background:transparent; border:1px solid var(--surface-2); color:#e5e7eb;
}
button.linklike.ghost:hover{ background:var(--surface-1) }

/* search highlight */
mark{
  background:#fde68a; color:#111827; padding:0 2px; border-radius:2px;
}

/* a11y helper */
.sr-only{
  position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,0,0); border:0;
}

/* ================================
   Rail Navigation (optional)
==================================*/
.railnav{
  position:fixed; right:18px; top:50%; transform:translateY(-50%);
  display:flex; flex-direction:column; gap:22px; z-index:40;
}
.rail-btn{
  all:unset; cursor:pointer; position:relative;
  width:28px; height:28px; display:flex; align-items:center; justify-content:center;
}
.rail-dot{
  width:10px; height:10px; border-radius:50%;
  background:#556178; transition:transform .25s, background .25s;
}
.rail-btn.band-intro .rail-dot{ background:var(--primary) }
.rail-btn.band-outro .rail-dot{ background:var(--accent) }
.rail-btn.active .rail-dot{
  background:linear-gradient(135deg,var(--primary),var(--accent));
  transform:scale(1.8);
}
.rail-btn .rail-label{
  position:absolute; right:40px; top:50%; transform:translateY(-50%) translateX(6px);
  opacity:0; pointer-events:none; font-size:12px; white-space:nowrap; color:var(--text);
  background:rgba(12,16,28,.85); border:1px solid var(--surface-2);
  padding:6px 10px; border-radius:8px;
  transition:opacity .2s, transform .2s;
}
.rail-btn:hover .rail-label{ opacity:1; transform:translateY(-50%) translateX(0) }

/* ================================
   Callout & KPI (generic polish)
==================================*/
.callout{
  padding:12px; border-radius:var(--radius-sm);
  border:1px solid var(--surface-2); background:var(--surface-0);
}
.kpi{
  padding:16px; border-radius:var(--radius-md);
  background:var(--surface-0); border:1px solid var(--surface-2); min-width:160px;
}

/* ================================
   Overlay <pre> code block
==================================*/
pre.code, .ov-card pre{
  background:#0f172a; color:#e5e7eb;
  padding:12px; border-radius:8px; overflow:auto;
  font-family:ui-monospace,SFMono-Regular,Menlo,monospace; font-size:12px;
}

/* ================================
   Responsive
==================================*/
@media (max-width: 900px){
  .section-panel{ padding:24px }
  .intro-title{ font-size:28px }
  .simple-table.audit thead th{ position:static }
  .audit-toolbar{ flex-wrap:wrap }
  .audit-toolbar .search{ max-width:100% }
}

/* ================================
   Print (보고용 내보내기)
==================================*/
@media print{
  body{ background:#fff; color:#000; animation:none }
  .intro-backdrop, .ov-backdrop, .railnav{ display:none !important }
  .section-panel{ box-shadow:none; background:#fff; border:1px solid #ddd }
  .simple-table.audit thead th{ position:static; backdrop-filter:none }
}

/* ───────── Iceberg ───────── */
.iceberg{
  position: relative;
  width: min(1040px, 92vw);
  height: 520px;
  border-radius: 24px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  box-shadow: 0 24px 80px rgba(0,0,0,.35);
  overflow: hidden;
  isolation: isolate;
}

.iceberg-bg{
  position: absolute; inset: 0;
  width: 100%; height: 100%;
}

.iceberg-pills{
  position: absolute; inset: 0;
  pointer-events: none;
}

.iceberg .pill{
  position: absolute; transform: translate(-50%,-50%);
  pointer-events: auto; cursor: pointer;
  padding: 6px 12px; border-radius: 999px;
  font-size: 12px; font-weight: 700;
  border: 1px solid rgba(255,255,255,.22);
  color: var(--text); white-space: nowrap;
  backdrop-filter: blur(6px);
  transition: transform .15s ease, background-color .15s ease, box-shadow .15s ease;
}

.pill-top{
  background: rgba(255,255,255,.12);
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
}
.pill-top:hover{ transform: translate(-50%,-52%) scale(1.04); }

.pill-bot{
  background: rgba(90,169,255,.10);
  box-shadow: 0 6px 20px rgba(20,110,200,.25);
}
.pill-bot:hover{ transform: translate(-50%,-52%) scale(1.05); }

/* 심각도 컬러 */
.pill-bot.sev-low    { border-color: rgba(124,77,255,.35); background: rgba(124,77,255,.16); }
.pill-bot.sev-medium { border-color: rgba(90,169,255,.35); background: rgba(90,169,255,.16); }
.pill-bot.sev-high   { border-color: rgba(217,119,6,.40);  background: rgba(217,119,6,.18);  }
.pill-bot.sev-critical{border-color: rgba(185,28,28,.45);  background: rgba(185,28,28,.20);  }

.iceberg-cap{
  position: absolute; left: 16px; bottom: 12px; opacity: .7; font-size: 12px;
}

/* 작은 파도 느낌 */
.iceberg::after{
  content: ""; position: absolute; left: -20%; right: -20%;
  top: calc(36% - 6px); height: 12px;
  background: radial-gradient(60% 100% at 50% 50%, rgba(255,255,255,.18), transparent 70%);
  animation: waveSlide 5.5s linear infinite;
  pointer-events: none;
  opacity: .5;
}
@keyframes waveSlide{
  from{ transform: translateX(0); }
  to  { transform: translateX(20%); }
}
/* 컨테이너 */
.icebug { --tiltX: 0deg; --tiltY: 0deg; }
.icebug-head {
  font-weight: 800; font-size: 22px; letter-spacing: .2px;
  margin-bottom: 10px; padding-left: 6px; opacity: .95;
}
.icebug-stage{
  position: relative;
  height: 520px;
  border-radius: 24px;
  padding: 10px;
  background:
    radial-gradient(1000px 600px at 70% 30%, rgba(124,77,255,.12), transparent 60%),
    radial-gradient(1000px 600px at 30% 10%, rgba(90,169,255,.12), transparent 60%),
    linear-gradient(180deg, #0f1a2a 0%, #0d1524 100%);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 20px 60px rgba(0,0,0,.35) inset, 0 14px 40px rgba(0,0,0,.35);
  overflow: hidden;
  perspective: 1000px;
}
.sky-slab{
  position:absolute; left:0; right:0; top:0; height:42%;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0));
  mix-blend-mode: screen; pointer-events:none;
}

/* 수면선 */
.waterline{
  position:absolute; left:0; right:0; top:50%;
  height:2px;
  background: linear-gradient(90deg,#9ec5ff40, #e8f3ffb0, #9ec5ff40);
  filter: blur(.3px);
  box-shadow: 0 0 18px #a7c9ff55;
}
.water-shimmer{
  position:absolute; left:-20%; right:-20%; top:42%;
  height:24px;
  background: radial-gradient(60% 120% at 50% 0%, #e1f0ff35 0%, #e1f0ff00 70%);
  -webkit-mask: repeating-linear-gradient(120deg, #000 0 18px, transparent 18px 36px);
  mask: repeating-linear-gradient(120deg, #000 0 18px, transparent 18px 36px);
  animation: shimmer 10s linear infinite;
  pointer-events:none;
}

/* 빙산 */
.iceberg{
  position:absolute; inset:0;
  transform-style: preserve-3d;
}
.berg {
  transform-origin: 50% 40%;
  animation: bob 7.5s ease-in-out infinite, drift 26s linear infinite;
  will-change: transform;
  transform: translateZ(0) rotateX(var(--tiltX)) rotateY(var(--tiltY));
}
/* .berg.tip { animation-delay: .1s; filter: drop-shadow(0 8px 16px rgba(0,0,0,.25)); } */
.berg.tip { display: none; }
.berg.mass{ transform-origin: 50% 55%; animation-delay: .2s; }

/* 파도 */
.waves{
  position:absolute; left:0; right:0; height:140px; top:40%;
}
.waves path{ fill: rgba(120,170,255,.20); }
.waves.back{ transform: translateZ(0); animation: wave 16s linear infinite; opacity:.55; }
.waves.front{ transform: translateZ(0); animation: wave 10s linear infinite reverse; opacity:.75; }

@keyframes wave{
  from{ transform: translateX(0) }
  to  { transform: translateX(-50%) }
}
@keyframes bob{
  0%,100%{ transform: translateY(0) rotateX(var(--tiltX)) rotateY(var(--tiltY)); }
  50%    { transform: translateY(6px) rotateX(calc(var(--tiltX) + 0.3deg)) rotateY(calc(var(--tiltY) - 0.3deg)); }
}
@keyframes drift{
  0%{ filter: drop-shadow(0 10px 24px rgba(40,70,120,.25)); }
  50%{ filter: drop-shadow(0 16px 28px rgba(40,70,120,.30)); }
  100%{ filter: drop-shadow(0 10px 24px rgba(40,70,120,.25)); }
}

/* 라벨 칩 */
.chip{
  position:absolute; transform: translate(-50%, -50%);
  padding: 6px 12px; border-radius: 999px; font-size: 12px; font-weight: 700;
  color:#e6eefc; white-space: nowrap; backdrop-filter: blur(4px);
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 0 6px 20px rgba(0,0,0,.25);
  user-select:none;
}
.chip.up   { background: rgba(255,255,255,.14); }
.chip.down { background: rgba(100,160,255,.18); }
.chip.tone-up { box-shadow: 0 8px 18px rgba(160,200,255,.25); }

/* 범례 */
.legend{
  position:absolute; left:18px; bottom:12px; font-size:12px; opacity:.65;
}

/* 접근성: 모션 최소화 */
@media (prefers-reduced-motion: reduce){
  .berg, .waves.back, .waves.front { animation: none !important; }
}
